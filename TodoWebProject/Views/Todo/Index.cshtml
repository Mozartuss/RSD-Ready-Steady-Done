@using Microsoft.AspNetCore.Authorization
@model TodoWebProjekt.ViewModel.IndexViewModel
@inject UserManager<ApplicationUser> UserManager
@inject SignInManager<ApplicationUser> SignInManager
@inject IAuthorizationService AuthorizationService


@{
    ViewBag.Title = "TODOS";
}


@if (SignInManager.IsSignedIn(User))
{
    <h2 style="font-stretch: semi-condensed; text-align: center;">TODOS</h2>

    <h5 style="font-stretch: semi-condensed; text-align: center;" id="OnlineUsers"></h5>
    <br />
    <br />
    <div id="partial">
    </div>
}
else
{
    <div class="container center">
        <div>
            <h1 class="noData">No <br /> Todos <br /> !</h1>
        </div>
        <div>
            <h2 class="noData_login">You have to <a asp-controller="Account" asp-action="Login" title="Login">Login</a> or <a asp-controller="Account" asp-action="Register" title="Register">Register</a></h2>
        </div>
    </div>
}

<div id="deleteDialog" class="modal fade">
    <div class="modal-dialog modal-confirm">
        <div class="modal-content">
            <div class="modal-header" style="background: #e85e6c;">
                <div class="icon-box">
                    <i class="fa fa-3x fa-trash-alt"></i>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body text-center">
                <h4>Delete!</h4>
                <p>Are you sure you want to delete this task ?</p>
                <button class="btn" style="background-color: #47c9a2; margin-right:2em" id="confirm"> <i class="fa fa-lg fa-check"></i></button>
                <button class="btn" style="background-color: #e85e6c" data-dismiss="modal"><i class="fa fa-lg fa-ban"></i></button>
            </div>
        </div>
    </div>
</div>

<div id="verifyEmailDialog" class="modal fade">
    <div class="modal-dialog modal-confirm">
        <div class="modal-content">
            <div class="modal-header" style="background: #101820FF;">
                <div class="icon-box" style="color: #FEE715FF">
                    <i class="fa fa-3x fa-envelope-open-text"></i>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body text-center">
                <h4>Please verify !</h4>
                <p>
                    Thanks for joining ! <br />
                    We sent you an email to <b>@TempData["Email"]</b> <br /> Please verify your email address.
                </p>
                <button class="btn btn-success" style="background-color: #FEE715FF; color:#101820FF; border: 2px solid #101820FF;" data-dismiss="modal"><span style="-webkit-text-stroke:medium"> Ok </span></button>
            </div>
        </div>
    </div>
</div>

<div id="emailConfirmed" class="modal fade">
    <div class="modal-dialog modal-confirm">
        <div class="modal-content">
            <div class="modal-header" style="background: #47c9a2;">
                <div class="icon-box">
                    <i class="fa fa-3x fa-check"></i>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body text-center">
                <h4>Awesome !</h4>
                <p>your email address has been successfully verified !</p>
                <button class="btn btn-success" data-dismiss="modal"><span>Start Exploring</span> <i class="fa fa-angle-right"></i></button>
            </div>
        </div>
    </div>
</div>

<div id="check" class="modal fade">
    <div class="modal-dialog modal-confirm">
        <div class="modal-content">
            <div class="modal-header" style="background: #47c9a2;">
                <div class="icon-box">
                    <i class="fa fa-3x fa-thumbs-up"></i>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body text-center">
                <h4>Awesome !</h4>
                <p>You did it ! </p>
                <button class="btn" style="background-color: #47c9a2;" id="confirmCheck">Continue</button>
            </div>
        </div>
    </div>
</div>

<div id="uncheck" class="modal fade">
    <div class="modal-dialog modal-confirm">
        <div class="modal-content">
            <div class="modal-header" style="background: #e85e6c;">
                <div class="icon-box">
                    <i class="fa fa-3x fa-thumbs-down"></i>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body text-center">
                <h4>Reopen!</h4>
                <p>Do you really want to reopen this Todo ? </p>
                <button class="btn" style="background-color: #e85e6c;" id="confirmUncheck">Continue</button>
            </div>
        </div>
    </div>
</div>


@section Scripts {

    <script>
        $("document").ready(function () {
            $("#partial").load("/Todo/LoadTodoList");
           
        });
    </script>

    <script src="~/js/Index.js"></script>

    @if (TempData["IsEmailSent"] != null && (bool)TempData["IsEmailSent"])
    {
        <script>
            $(function () {
                $("#verifyEmailDialog").modal('show');
                window.onclick = function (event) {
                    if (event.target == modal) {
                        modal.style.display = "none";
                    }
                }
            });
        </script>
    }

    @if (TempData["EmailConfirmation"] != null && (bool)TempData["EmailConfirmation"])
    {
        <script>
            $(function () {
                $("#emailConfirmed").modal('show');
                window.onclick = function (event) {
                    if (event.target == modal) {
                        modal.style.display = "none";
                    }
                }
            });
        </script>
    }
}
